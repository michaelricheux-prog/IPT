
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>PoC Planification des Op√©rations (FastAPI + Gantt)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- ‚úÖ Ton CSS -->
  <link rel="stylesheet" href="/static/styles.css">

  <!-- ‚úÖ Frappe Gantt (CDN) : CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/frappe-gantt/dist/frappe-gantt.css">
  
</head>
<body>
  <main>
    <h1>PoC Planification des Op√©rations (FastAPI + Gantt)</h1>

    <!-- üè¢ Outil de Planification des Op√©rations (PoC) -->
    <section class="panel">
      <h2>üè¢ Outil de Planification des Op√©rations (PoC)</h2>
      <div id="planning-panel" class="hidden">
        <h3>‚è± Planification en temps r√©el</h3>
        <div class="row">
          <label><input type="radio" name="mode" value="asap" checked> ASAP (date au plus t√¥t)</label>
          <label><input type="radio" name="mode" value="retro"> RETRO (date au plus tard)</label>
        </div>
        <div class="row" id="asap-row">
          <label>
            Date de d√©part (ASAP)
            <input type="datetime-local" id="start_date">
          </label>
        </div>
        <div class="row hidden" id="retro-row">
          <label>
            Date d‚Äô√©ch√©ance (RETRO)
            <input type="datetime-local" id="due_date">
          </label>
        </div>
        <div class="row">
          <button class="primary" id="btn-run">Calculer les dates</button>
          <button id="btn-refresh">Rafra√Æchir la liste</button>
          <span class="status mono" id="status-planning">Pr√™t.</span>
        </div>
      </div>
    </section>

    <!-- üìà Diagramme de Gantt des Op√©rations -->
    <section class="panel">
      <h2>üìà Diagramme de Gantt des Op√©rations</h2>
      <!-- Conteneur Gantt (rendu par Frappe Gantt) -->
      <div id="gantt" class="gantt-container"></div>
    </section>

    <!-- ‚ûï Cr√©er une nouvelle Op√©ration (POST) -->
    <section class="panel">
      <h2>‚ûï Cr√©er une nouvelle Op√©ration (POST)</h2>
      <div class="row">
        <label>Nom<input id="c_nom" placeholder="Nom de l'op√©ration"></label>
        <label>Qt√© √† produire<input id="c_qap" type="number" step="0.01"></label>
        <label>Temps pr√©vu (h)<input id="c_tp" type="number" step="0.01"></label>
        <label>Dur√©e pr√©vue (sem.)<input id="c_dps" type="number" step="0.01"></label>
        <label>Centre charge ID<input id="c_cc" type="number" step="1"></label>
        <label>OF ID<input id="c_of" type="number" step="1"></label>
        <label>D√©pend de (ID pr√©c√©dent)<input id="c_prev" type="number" step="1"></label>
      </div>
      <div class="row">
        <button class="primary" id="btn-create">Cr√©er l'Op√©ration</button>
        <span class="status mono" id="status-create">Pr√™t.</span>
      </div>
    </section>

    <!-- ‚úèÔ∏è Modifier / Cl√¥turer une Op√©ration (PATCH) -->
    <section class="panel">
      <h2>‚úèÔ∏è Modifier / Cl√¥turer une Op√©ration (PATCH)</h2>
      <div class="row">
        <label>ID de l'op√©ration<input id="u_id" type="number" step="1" placeholder="ID"></label>
        <label>Nom<input id="u_nom" placeholder="(optionnel)"></label>
        <label>Qt√© produite<input id="u_qp" type="number" step="0.01"></label>
        <label>Temps pass√© (h)<input id="u_tpasse" type="number" step="0.01"></label>
        <label>Qt√© √† produire<input id="u_qap" type="number" step="0.01"></label>
        <label>Dur√©e pr√©vue (sem.)<input id="u_dps" type="number" step="0.01"></label>
        <label>Centre charge ID<input id="u_cc" type="number" step="1"></label>
        <label>OF ID<input id="u_of" type="number" step="1"></label>
        <label>D√©pend de (ID pr√©c√©dent)<input id="u_prev" type="number" step="1"></label>
        <label><input id="u_realisee" type="checkbox"> Op√©ration R√©alis√©e / Cl√¥tur√©e ?</label>
      </div>
      <div class="row">
        <button class="primary" id="btn-update">Appliquer les Modifications</button>
        <span class="status mono" id="status-update">Pr√™t.</span>
      </div>
    </section>

    <!-- üìã Liste des Op√©rations (GET) -->
    <section class="panel">
      <h2>üìã Liste des Op√©rations (GET)</h2>
      <div class="row">
        <label>Recherche (nom contient)<input id="q" placeholder="ex: montage"></label>
        <label>R√©alis√©e
          <select id="est">
            <option value="">(toutes)</option>
            <option value="true">oui</option>
            <option value="false">non</option>
          </select>
        </label>
        <label>Centre charge ID<input id="f_cc" type="number" step="1"></label>
        <label>OF ID<input id="f_of" type="number" step="1"></label>
        <label>Trier par
          <select id="order_by">
            <option value="id">id</option>
            <option value="nom">nom</option>
            <option value="quantite_a_produire">qte √† produire</option>
            <option value="quantite_produite">qte produite</option>
            <option value="temps_prevu">temps pr√©vu</option>
            <option value="temps_passe">temps pass√©</option>
            <option value="duree_prevue_semaine">dur√©e pr√©vue (sem.)</option>
            <option value="centre_charge_id">centre charge</option>
            <option value="ordre_fabrication_id">OF</option>
            <option value="est_realisee">r√©alis√©e</option>
          </select>
        </label>
        <select id="order_dir">
          <option value="asc">asc</option>
          <option value="desc">desc</option>
        </select>
        <label>Page<input id="page" type="number" value="1" min="1"></label>
        <label>Taille<input id="size" type="number" value="20" min="1" max="100"></label>
        <button id="btn-load">Actualiser</button>
        <span class="status mono" id="status-list">Pr√™t.</span>
      </div>

      <table>
        <thead>
          <tr>
            <th>ID</th><th>Nom</th><th>OF ID</th><th>Qt√© √† Prod.</th><th>Qt√© Prod.</th>
            <th>Temps Pr√©vu (h)</th><th>Temps Pass√© (h)</th><th>Dur√©e Pr√©vue (sem.)</th>
            <th>Centre Charge ID</th><th>D√©pend de (ID)</th><th>R√©alis√©e</th><th>Action</th>
          </tr>
        </thead>
        <tbody id="tbody-blocs">
          <tr><td colspan="12" class="mono">Chargement‚Ä¶</td></tr>
        </tbody>
      </table>
    </section>
  </main>

  <!-- ‚úÖ Frappe Gantt (CDN) : JS -->
  <script src="https://cdn.jsdelivr.net/npm/frappe-gantt/dist/frappe-gantt.umd.js"></script>

  <!-- ‚úÖ Ton JS (contient le rendu Gantt avec new Gantt('#gantt', tasks, options) ) -->
 <script src="/static/app.js"></script>
</body>
